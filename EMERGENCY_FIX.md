# üö® EMERGENCY FIX: 500 Error

## –ü—Ä–æ–±–ª–µ–º–∞
Backend –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π 500 –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è scaling –∏–∑–º–µ–Ω–µ–Ω–∏–π.

## –ü—Ä–∏—á–∏–Ω–∞
Railway –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å `cacheService.js` –∏–ª–∏ –µ—Å—Ç—å –±–∞–≥ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

---

## ‚ö° –°–†–û–ß–ù–û–ï –†–ï–®–ï–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è, —á—Ç–æ–±—ã —Å–∞–π—Ç —Å–Ω–æ–≤–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–ª:**

```bash
# –í Git Bash
cd "c:/Users/la1wo/OneDrive/–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª/web3/near-analytics-bot"

# –û—Ç–∫–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–º–∏—Ç–∞
git revert HEAD --no-edit

# Push
git push origin master
```

**–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:**
```
rollback.bat
```

–ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-3 –º–∏–Ω—É—Ç—ã ‚Üí —Å–∞–π—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç!

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ (–°–õ–û–ñ–ù–ï–ï)

–ü—Ä–æ–±–ª–µ–º–∞ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –≤ —Ç–æ–º, —á—Ç–æ `cacheService.js` –Ω–µ –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ Railway.

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**

1. Railway logs:
```bash
railway logs --tail
```

–ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å –æ—à–∏–±–∫–æ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```
Error: Cannot find module './cacheService'
```

2. –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –∑–Ω–∞—á–∏—Ç –æ–Ω –Ω–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ git:
```bash
git status
git add src/services/cacheService.js
git commit -m "fix: add missing cacheService.js"
git push origin master
```

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Railway –ª–æ–≥–∏

```bash
railway logs --tail | grep "Error"
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

#### 1. `Cannot find module './cacheService'`
**–†–µ—à–µ–Ω–∏–µ:**
```bash
git add src/services/cacheService.js
git commit --amend --no-edit
git push --force origin master
```

#### 2. `cacheService.getStats is not a function`
**–†–µ—à–µ–Ω–∏–µ:** –£–±—Ä–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `getStats()` –∏–∑ `api.js`

#### 3. `setInterval is not defined`
**–†–µ—à–µ–Ω–∏–µ:** –£–±—Ä–∞—Ç—å `setInterval` –∏–∑ `cacheService.js`

---

## üõ†Ô∏è –ü–ª–∞–Ω –ë: –î–µ–ø–ª–æ–π –±–µ–∑ –∫—ç—à–∞

–ï—Å–ª–∏ –æ—Ç–∫–∞—Ç –Ω–µ –ø–æ–º–æ–≥, –º–æ–∂–µ–º –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –≤–µ—Ä—Å–∏—é –ë–ï–ó –∫—ç—à–∞, –Ω–æ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π:

1. –£–¥–∞–ª–∏—Ç—å `cacheService.js`
2. –£–±—Ä–∞—Ç—å –≤—Å–µ `cacheService.set/get` –∏–∑ `nearService.js`
3. –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–∞–≥–∏–Ω–∞—Ü–∏—é
4. –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å

**–≠—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–±–µ–∑ –∫—ç—à–∞).**

---

## ‚úÖ –ü–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞

1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 3-4 –º–∏–Ω—É—Ç—ã
2. –û—Ç–∫—Ä–æ–π—Ç–µ: `https://your-api.railway.app/api/health`
3. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: `"status": "ok"`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å: —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏?
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: —Ä–∞–±–æ—Ç–∞—é—Ç –ª–∏?

**–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Üí –º–æ–∂–µ–º —Å–ø–æ–∫–æ–π–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å —Å–Ω–æ–≤–∞!

---

## üìû –ï—Å–ª–∏ –æ—Ç–∫–∞—Ç –Ω–µ –ø–æ–º–æ–≥

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Railway dashboard: https://railway.app
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –û—Ç–∫—Ä–æ–π—Ç–µ Deployments
4. –í—ã–±–µ—Ä–∏—Ç–µ **–ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Å–ø–µ—à–Ω—ã–π** deployment
5. –ù–∞–∂–º–∏—Ç–µ **Redeploy**

–≠—Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é —Ä–∞–±–æ—á—É—é –≤–µ—Ä—Å–∏—é!

---

## üîß –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞)

–ü—Ä–æ–±–ª–µ–º–∞: Railway –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å `setInterval` –≤ module scope.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

1. –£–±—Ä–∞—Ç—å `setInterval` –∏–∑ `cacheService.js`
2. –í—ã–∑—ã–≤–∞—Ç—å `cleanExpired()` —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö
3. –ò–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—á–∏—Å—Ç–∫—É –≤ `api.js` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π `cacheService.js`:**
```javascript
// –£–±—Ä–∞—Ç—å —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏:
// setInterval(() => {
//   cacheService.cleanExpired();
// }, 2 * 60 * 1000);

// –î–æ–±–∞–≤–∏—Ç—å –≤ api.js:
// –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞:
setInterval(() => {
  cacheService.cleanExpired();
}, 2 * 60 * 1000);
```

---

‚ú® **–°–Ω–∞—á–∞–ª–∞ –æ—Ç–∫–∞—Ç–∏—Ç–µ, –ø–æ—Ç–æ–º –∏—Å–ø—Ä–∞–≤–∏–º!**
